(function(){function r(a){return new Promise(b=>setTimeout(b,a))}function K(a){if(D){a=a.target;let [b,f]=[a.id.split("-")[1],a.id.split("-")[2]];k[b][f].j=!0;g(b,f).classList.add("wall")}}function g(a,b){return document.getElementById("cell-"+a+"-"+b)}function E(){F&&G&&(document.getElementById("start").removeEventListener("click",E),document.getElementById("start").disabled=!0,document.getElementById("visualization_mode").disabled=!0,document.getElementById("visualization_mode").classList.add("hidden"),
document.getElementById("vis_label").classList.add("hidden"),t=!0,L(H),m?r(n*p*2.5).then(()=>u(A)):u(A))}function u(a){a.path=!0;if(0!==a.h||a.o)a.o||(g(a.x,a.y).style.backgroundColor="cadetblue"),m?r(200).then(()=>u(a.s())):u(a.s())}function L(a){let b=1,f=new q;a.l=!0;for(f.m(a);!f.v();){b++;let c=f.u();for(let d of c.g.reverse()){let e=k[d[0]][d[1]];if(2===d[3]&&v(1,3,c,2))c.g.splice(c.g.indexOf(d),1);else if(4===d[3]&&v(3,5,c,4))c.g.splice(c.g.indexOf(d),1);else if(6===d[3]&&v(5,7,c,6))c.g.splice(c.g.indexOf(d),
1);else if(8===d[3]&&v(7,1,c,8))c.g.splice(c.g.indexOf(d),1);else{if(e.o)return;e.h>c.h+d[2]&&e.l&&(e.h=c.h+d[2],m&&r(3*b).then(()=>{g(e.x,e.y).textContent=(c.h+d[2]).toString().substr(0,5)}));e.l||e.j||(e.l=!0,e.B=e.h,e.h=c.h+d[2],m&&r(2*b).then(()=>{g(e.x,e.y).textContent=(c.h+d[2]).toString().substr(0,5);g(e.x,e.y).style.backgroundColor="orange"}),g(e.x,e.y).style.fontSize="8px",e.j||f.m(e))}}}}function v(a,b,f,c){let d=null,e=null,h=null;for(let l of f.g)l[3]===a&&(d=k[l[0]][l[1]]),l[3]===b&&
(e=k[l[0]][l[1]]),l[3]===c&&(h=k[l[0]][l[1]]);return null===d||null===e||null==h?!1:d.j&&e.j?!h.j:!1}function M(a){!t&&w&&x&&!I&&(n=Number(y.value),p=Number(z.value),y.disabled=!0,z.disabled=!0,a.target.classList.add("hidden"),document.getElementById("start").disabled=!1,document.getElementById("start").classList.remove("hidden"),N(),I=!0)}function O(a){/^\d{0,2}$/.test(a.target.value)&&75>=Number(a.target.value)&&0<Number(a.target.value)&&""!==a.target.value?(w=!0,a=document.getElementById("invalidRows"),
"undefined"!=typeof a&&null!=a&&a.remove()):(w&&(a=document.createElement("p"),a.id="invalidRows",a.textContent="Valid range is 1-75 rows",a.classList.add("bad"),document.getElementById("messages").insertBefore(a,document.getElementById("messages").firstChild)),w=!1)}function P(a){/^\d{0,2}$/.test(a.target.value)&&75>=Number(a.target.value)&&0<Number(a.target.value)&&""!==a.target.value?(x=!0,a=document.getElementById("invalidCols"),"undefined"!=typeof a&&null!=a&&a.remove()):(x&&(a=document.createElement("p"),
a.id="invalidCols",a.textContent="Valid range is 1-75 columns",a.classList.add("bad"),document.getElementById("messages").insertBefore(a,document.getElementById("messages").firstChild)),x=!1)}function B(a){D=void 0===a.buttons?1===a.which:1===a.buttons}function N(){for(let a=0;a<p;a++){k.push([]);const b=document.createElement("div");b.id="col-"+a;b.classList.add("col");b.draggable=!1;b.i=function(){return!1};Q.appendChild(b);for(let f=0;f<n;f++){const c=new R(a,f);k[a].push(c);k[a][f].A();const d=
document.createElement("div");d.id="cell-"+a+"-"+f;d.classList.add("cell");b.appendChild(d);d.addEventListener("click",()=>c.i());d.addEventListener("dblclick",()=>c.m());d.draggable=!1;d.i=function(){return!1}}}}let t=!1,w=!0,x=!0,I=!1,n=30,p=30,J=!0,C=!1,F=!1,G=!1,D=!1,m=!1,A,H;const k=[],Q=document.getElementById("gameBoard_UI"),y=document.getElementById("rowsInput"),z=document.getElementById("colsInput");class R{constructor(a,b){this.x=a;this.y=b;this.g=[];this.o=this.path=this.j=!1;this.h=0;
this.l=!1}A(){const a=[-1,0,1];for(let e of a)for(let h of a){var b=this.x+e,f=this.y+h;if(0<=b&&b<p&&0<=f&&f<n&&(0!==e||0!==h)){b=this.x;f=this.y;var c=this.x+e,d=this.y+h;b=c===b&&d<f?1:c>b&&d<f?2:c>b&&d===f?3:c>b&&d>f?4:c===b&&d>f?5:c<b&&d>f?6:c<b&&d===f?7:8;0===e||0===h?this.g.push([this.x+e,this.y+h,1,b]):this.g.push([this.x+e,this.y+h,Math.sqrt(2),b])}}}s(){let a=Infinity,b=null;for(let f of this.g){let c=k[f[0]][f[1]];c.h<a&&c.l&&(a=c.h,b=c)}return b}i(){if(J&&!t)this.o=!0,g(this.x,this.y).classList.add("start"),
A=this,J=!1,F=C=!0;else if(C&&!t){H=this;g(this.x,this.y).classList.add("end");C=!1;G=!0;for(let a=0;a<p;a++)for(let b=0;b<n;b++)g(a,b).addEventListener("mouseover",K)}}m(){this.j&&(this.j=!1,g(this.x,this.y).classList.remove("wall"))}}(function(){document.getElementById("start").addEventListener("click",E);document.getElementById("buildGrid").addEventListener("click",M);document.getElementById("visualization_mode").addEventListener("input",()=>{m=!m});m=document.getElementById("visualization_mode").checked;
document.body.onmousedown=B;document.body.onmousemove=B;document.body.onmouseup=B;y.addEventListener("input",O);z.addEventListener("input",P);z.value="30";y.value="30";document.getElementById("start").disabled=!0})();class q{constructor(){this.i=[]}}q.prototype.m=function(a){this.i.push(a)};q.prototype.u=function(){return this.i.shift()};q.prototype.v=function(){return 0===this.i.length};q.prototype.length=function(){return this.i.length}})();
