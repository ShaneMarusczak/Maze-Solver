(function(){function x(a){return new Promise(b=>setTimeout(b,a))}function R(a){if(I&&!p){let [b,e]=J(a.target),c=g[b][e];c.m||c.l||c.h||(c.h=!0,a.target.classList.add("wall"))}}function h(a,b){return document.getElementById("cell-"+a+"-"+b)}function S(){for(let a=0;a<k;a++)for(let b=0;b<l;b++)g[a][b].checked=!1}function K(a){for(let b=0;b<k;b++)for(let e=0;e<l;e++){let c=g[b][e],d=h(b,e);c.path=!1;c.h||(c.l=!1,d.classList.remove("end"),d.classList.remove("path"),c.o=!1,c.i=0,d.textContent="",a&&c.C())}}
function T(a){a=a.target;let [b,e]=J(a),c=g[b][e];c.h||c.m||(K(!1),c.l=!0,a.classList.add("end"),r=c,E(r),y&&t(w))}function L(){M&&N&&!p&&(document.getElementById("start").removeEventListener("click",L),document.getElementById("start").disabled=!0,document.getElementById("visualization_mode").disabled=!0,document.getElementById("visualization_mode").classList.add("hidden"),document.getElementById("vis_label").classList.add("hidden"),document.getElementById("mouse_mode").disabled=!0,document.getElementById("mouse_mode").classList.add("hidden"),
document.getElementById("mouse_label").classList.add("hidden"),q&&Array.from(document.querySelectorAll(".cell")).forEach(a=>{a.addEventListener("mouseover",T)}),p=!0,E(r),n||q||U(),V(),y&&(n?x(k*l*2.5).then(()=>t(w)):t(w)))}function V(){for(let a=0;a<k;a++)for(let b=0;b<l;b++)h(a,b).classList.remove("cell_hover")}function U(){for(let a=0;a<k;a++)for(let b=0;b<l;b++){let e=g[a][b];e.o||(e.h=!0,h(a,b).classList.add("wall"))}}function t(a){a.path=!0;0!==a.i&&(a.m||(h(a.x,a.y).classList.remove("visited"),
h(a.x,a.y).classList.add("path")),n&&!q?x(200).then(()=>t(a.v())):t(a.v()))}function O(a){let b=new u;a.checked=!0;for(b.u(a);!b.B();){a=b.A();for(let e of a.g.reverse()){a=g[e.x][e.y];if(a.m)return!0;a.checked||a.h||(a.checked=!0,a.h||b.u(a))}}return!1}function E(a){let b=1,e=new u;a.o=!0;for(e.u(a);!e.B();){b++;let c=e.A();for(let d of c.g.reverse()){let f=g[d.x][d.y];if("NE"===d.direction&&z("N","E",c,"NE"))c.g.splice(c.g.indexOf(d),1);else if("SE"===d.direction&&z("S","E",c,"SE"))c.g.splice(c.g.indexOf(d),
1);else if("SW"===d.direction&&z("S","W",c,"SW"))c.g.splice(c.g.indexOf(d),1);else if("NW"===d.direction&&z("N","W",c,"NW"))c.g.splice(c.g.indexOf(d),1);else if(f.m&&(y=!0),f.i>c.i+d.s&&f.o&&(f.i=c.i+d.s,n&&x(3*b).then(()=>{h(f.x,f.y).textContent=(c.i+d.s).toString().substr(0,5)})),!f.o&&!f.h){f.o=!0;f.i=c.i+d.s;let v=h(f.x,f.y);n&&!f.m&&x(2*b).then(()=>{v.textContent=(c.i+d.s).toString().substr(0,5);v.classList.add("visited")});f.h||e.u(f)}}}}function z(a,b,e,c){let d=null,f=null,v=null;for(let m of e.g)m.direction===
a&&(d=g[m.x][m.y]),m.direction===b&&(f=g[m.x][m.y]),m.direction===c&&(v=g[m.x][m.y]);return null===d||null===f||null===v?!1:d.h&&f.h?!v.h:!1}function J(a){return[a.id.split("-")[1],a.id.split("-")[2]]}function W(a){!p&&A&&B&&!P&&(k=Number(C.value),l=Number(D.value),C.disabled=!0,D.disabled=!0,a.target.classList.add("hidden"),document.getElementById("start").disabled=!1,document.getElementById("start").classList.remove("hidden"),X(),P=!0)}function Y(a){/^\d{0,2}$/.test(a.target.value)&&75>=Number(a.target.value)&&
0<Number(a.target.value)&&""!==a.target.value?(A=!0,a=document.getElementById("invalidRows"),"undefined"!=typeof a&&null!=a&&a.remove()):(A&&(a=document.createElement("p"),a.id="invalidRows",a.textContent="Valid range is 1-75 rows",a.classList.add("bad"),document.getElementById("messages").insertBefore(a,document.getElementById("messages").firstChild)),A=!1)}function Z(a){/^\d{0,2}$/.test(a.target.value)&&75>=Number(a.target.value)&&0<Number(a.target.value)&&""!==a.target.value?(B=!0,a=document.getElementById("invalidCols"),
"undefined"!=typeof a&&null!=a&&a.remove()):(B&&(a=document.createElement("p"),a.id="invalidCols",a.textContent="Valid range is 1-75 columns",a.classList.add("bad"),document.getElementById("messages").insertBefore(a,document.getElementById("messages").firstChild)),B=!1)}function F(a){I=void 0===a.buttons?1===a.which:1===a.buttons}function X(){for(let a=0;a<l;a++){g.push([]);const b=document.createElement("div");b.id="col-"+a;b.classList.add("col");b.draggable=!1;b.j=function(){return!1};G.appendChild(b);
for(let e=0;e<k;e++){const c=new aa(a,e);g[a].push(c);g[a][e].C();const d=document.createElement("div");d.id="cell-"+a+"-"+e;d.classList.add("cell");d.classList.add("cell_hover");625>l*k?d.classList.add("large_cell"):1600>l*k?d.classList.add("medium_cell"):3600>l*k?d.classList.add("small_cell"):d.classList.add("x-small_cell");b.appendChild(d);d.addEventListener("mouseup",f=>c.j(f));d.draggable=!1;d.j=function(){return!1}}}}let p=!1,P=!1,A=!0,B=!0,k=30,l=30,Q=!0,H=!1,M=!1,N=!1,I=!1,n=!1,q=!1,y=!1,
w,r;const g=[],G=document.getElementById("gameBoard_UI"),C=document.getElementById("rowsInput"),D=document.getElementById("colsInput");class aa{constructor(a,b){this.x=a;this.y=b;this.g=[];this.l=this.m=this.path=this.h=!1;this.i=0;this.checked=this.o=!1}C(){this.g=[];const a=[-1,0,1];for(let c of a)for(let d of a){var b=this.x+c,e=this.y+d;0<=b&&b<l&&0<=e&&e<k&&(0!==c||0!==d)&&(b=0===c&&-1===d?"N":1===c&&-1===d?"NE":1===c&&0===d?"E":1===c&&1===d?"SE":0===c&&1===d?"S":-1===c&&1===d?"SW":-1===c&&0===
d?"W":"NW",0===c||0===d?this.g.push({x:this.x+c,y:this.y+d,s:1,direction:b}):this.g.push({x:this.x+c,y:this.y+d,s:Math.sqrt(2),direction:b}))}}v(){let a=Infinity,b=null;for(let e of this.g){let c=g[e.x][e.y];c.i<a&&c.o&&!c.h&&(a=c.i,b=c)}return b}j(a){if(0===a.button)if(Q&&!p)this.m=!0,h(this.x,this.y).classList.add("start"),w=this,Q=!1,M=H=!0;else{if(H&&!p)for(r=this,this.l=!0,h(this.x,this.y).classList.add("end"),H=!1,N=!0,a=0;a<l;a++)for(let b=0;b<k;b++)h(a,b).addEventListener("mouseover",R)}else 2===
a.button&&this.u()}u(){S();if(q&&p){var a=h(this.x,this.y);if(this.h)this.h=!1,a.classList.remove("wall"),0<this.g.filter(b=>{let e="N"===b.direction||"E"===b.direction||"S"===b.direction||"W"===b.direction;return!g[b.x][b.y].h&&e}).length&&O(this)&&(K(!0),this.l=!0,a.classList.add("end"),r=this,E(r),y&&t(w));else if(this.h=!0,this.path=!1,a.classList.add("wall"),this.l=!1,a.classList.remove("end"),O(this)){let {x:b,y:e}=this.g.find(c=>g[c.x][c.y].path);g[b][e].path=!1;h(b,e).classList.remove("path");
g[b][e].l=!0;h(b,e).classList.add("end")}}}}(function(){document.getElementById("start").addEventListener("click",L);document.getElementById("buildGrid").addEventListener("click",W);document.getElementById("visualization_mode").addEventListener("input",()=>{if(n=!n)q=document.getElementById("mouse_mode").checked=!1});document.getElementById("visualization_mode").checked=!1;document.getElementById("mouse_mode").addEventListener("input",()=>{if(q=!q)n=document.getElementById("visualization_mode").checked=
!1});document.getElementById("mouse_mode").checked=!1;document.body.onmousedown=F;document.body.onmousemove=F;document.body.onmouseup=F;C.addEventListener("input",Y);D.addEventListener("input",Z);D.value="30";C.value="30";document.getElementById("start").disabled=!0;document.oncontextmenu=()=>!1;document.draggable=!1;document.j=function(){return!1};G.draggable=!1;G.j=function(){return!1}})();class u{constructor(){this.j=[]}}u.prototype.u=function(a){this.j.push(a)};u.prototype.A=function(){return this.j.shift()};
u.prototype.B=function(){return 0===this.j.length};u.prototype.length=function(){return this.j.length}})();
