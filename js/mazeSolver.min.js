(function(){function v(a){return new Promise(d=>setTimeout(d,a))}function P(a){if(H&&!q){let [d,f]=I(a.target);k[d][f].i=!0;l(d,f).classList.add("wall")}}function l(a,d){return document.getElementById("cell-"+a+"-"+d)}function Q(a){a=a.target;let [d,f]=I(a),b=k[d][f];if(!b.i&&!b.l&&b.m){for(let c=0;c<m;c++)for(let e=0;e<n;e++){let g=k[c][e],h=l(c,e);g.i||(g.s&&(g.s=!1,h.classList.remove("end")),g.path=!1,g.m=!1,g.g=0,g.D(),h.textContent="",g.l||(h.style.backgroundColor="rgb(201, 201, 201, 0.4)"))}a.style.backgroundColor=
"blue";b.s=!0;w=b;J(w);D&&t(x)}}function K(){L&&M&&!q&&(document.getElementById("start").removeEventListener("click",K),document.getElementById("start").disabled=!0,document.getElementById("visualization_mode").disabled=!0,document.getElementById("visualization_mode").classList.add("hidden"),document.getElementById("vis_label").classList.add("hidden"),document.getElementById("mouse_mode").disabled=!0,document.getElementById("mouse_mode").classList.add("hidden"),document.getElementById("mouse_label").classList.add("hidden"),
r&&Array.from(document.querySelectorAll(".cell")).forEach(a=>{a.addEventListener("mouseover",Q)}),q=!0,J(w),R(),D&&(p?v(m*n*2.5).then(()=>t(x)):t(x)))}function R(){for(let a=0;a<m;a++)for(let d=0;d<n;d++){let f=k[a][d];f.m||(f.i=!0,l(a,d).classList.add("wall"))}}function t(a){a.path=!0;if(0!==a.g||a.l)a.l||(l(a.x,a.y).style.backgroundColor="rgb(25,25,112)"),p&&!r?v(200).then(()=>t(a.v())):t(a.v())}function J(a){let d=1,f=new u;a.m=!0;for(f.u(a);!f.C();){d++;let b=f.B();for(let c of b.h.reverse()){let e=
k[c.x][c.y];if("NE"===c.direction&&y("N","E",b,"NE"))b.h.splice(b.h.indexOf(c),1);else if("SE"===c.direction&&y("S","E",b,"SE"))b.h.splice(b.h.indexOf(c),1);else if("SW"===c.direction&&y("S","W",b,"SW"))b.h.splice(b.h.indexOf(c),1);else if("NW"===c.direction&&y("N","W",b,"NW"))b.h.splice(b.h.indexOf(c),1);else if(e.l&&(D=!0),e.g>b.g+c.o&&e.m&&(e.g=b.g+c.o,p&&v(3*d).then(()=>{l(e.x,e.y).textContent=(b.g+c.o).toString().substr(0,5)})),!e.m&&!e.i){e.m=!0;e.g=b.g+c.o;let g=l(e.x,e.y),h="rgb(50,"+(175-
Math.floor(e.g))+","+(100-Math.floor(e.g))+")";r&&!e.l?g.style.backgroundColor=h:p&&!e.l&&v(2*d).then(()=>{g.textContent=(b.g+c.o).toString().substr(0,5);g.style.backgroundColor=h});e.i||f.u(e)}}}}function y(a,d,f,b){let c=null,e=null,g=null;for(let h of f.h)h.direction===a&&(c=k[h.x][h.y]),h.direction===d&&(e=k[h.x][h.y]),h.direction===b&&(g=k[h.x][h.y]);return null===c||null===e||null===g?!1:c.i&&e.i?!g.i:!1}function I(a){return[a.id.split("-")[1],a.id.split("-")[2]]}function S(a){!q&&z&&A&&!N&&
(m=Number(B.value),n=Number(C.value),B.disabled=!0,C.disabled=!0,a.target.classList.add("hidden"),document.getElementById("start").disabled=!1,document.getElementById("start").classList.remove("hidden"),T(),N=!0)}function U(a){/^\d{0,2}$/.test(a.target.value)&&75>=Number(a.target.value)&&0<Number(a.target.value)&&""!==a.target.value?(z=!0,a=document.getElementById("invalidRows"),"undefined"!=typeof a&&null!=a&&a.remove()):(z&&(a=document.createElement("p"),a.id="invalidRows",a.textContent="Valid range is 1-75 rows",
a.classList.add("bad"),document.getElementById("messages").insertBefore(a,document.getElementById("messages").firstChild)),z=!1)}function V(a){/^\d{0,2}$/.test(a.target.value)&&75>=Number(a.target.value)&&0<Number(a.target.value)&&""!==a.target.value?(A=!0,a=document.getElementById("invalidCols"),"undefined"!=typeof a&&null!=a&&a.remove()):(A&&(a=document.createElement("p"),a.id="invalidCols",a.textContent="Valid range is 1-75 columns",a.classList.add("bad"),document.getElementById("messages").insertBefore(a,
document.getElementById("messages").firstChild)),A=!1)}function E(a){H=void 0===a.buttons?1===a.which:1===a.buttons}function T(){for(let a=0;a<n;a++){k.push([]);const d=document.createElement("div");d.id="col-"+a;d.classList.add("col");d.draggable=!1;d.j=function(){return!1};F.appendChild(d);for(let f=0;f<m;f++){const b=new W(a,f);k[a].push(b);k[a][f].A();const c=document.createElement("div");c.id="cell-"+a+"-"+f;c.classList.add("cell");625>n*m?c.classList.add("large_cell"):1600>n*m?c.classList.add("medium_cell"):
3600>n*m?c.classList.add("small_cell"):c.classList.add("x-small_cell");d.appendChild(c);c.addEventListener("click",()=>b.j());c.addEventListener("dblclick",()=>b.u());c.draggable=!1;c.j=function(){return!1}}}}let q=!1,N=!1,z=!0,A=!0,m=30,n=30,O=!0,G=!1,L=!1,M=!1,H=!1,p=!1,r=!1,D=!1,x,w;const k=[],F=document.getElementById("gameBoard_UI"),B=document.getElementById("rowsInput"),C=document.getElementById("colsInput");class W{constructor(a,d){this.x=a;this.y=d;this.h=[];this.s=this.l=this.path=this.i=
!1;this.g=0;this.m=!1}A(){const a=[-1,0,1];for(let b of a)for(let c of a){var d=this.x+b,f=this.y+c;0<=d&&d<n&&0<=f&&f<m&&(0!==b||0!==c)&&(d=0===b&&-1===c?"N":1===b&&-1===c?"NE":1===b&&0===c?"E":1===b&&1===c?"SE":0===b&&1===c?"S":-1===b&&1===c?"SW":-1===b&&0===c?"W":"NW",0===b||0===c?this.h.push({x:this.x+b,y:this.y+c,o:1,direction:d}):this.h.push({x:this.x+b,y:this.y+c,o:Math.sqrt(2),direction:d}))}}D(){this.h=[];this.A()}v(){let a=Infinity,d=null;for(let f of this.h){let b=k[f.x][f.y];b.g<a&&b.m&&
!b.i&&(a=b.g,d=b)}return d}j(){if(O&&!q)this.l=!0,l(this.x,this.y).classList.add("start"),x=this,O=!1,L=G=!0;else if(G&&!q){w=this;this.s=!0;l(this.x,this.y).classList.add("end");G=!1;M=!0;for(let a=0;a<n;a++)for(let d=0;d<m;d++)l(a,d).addEventListener("mouseover",P)}}u(){this.i&&(this.i=!1,l(this.x,this.y).classList.remove("wall"))}}(function(){document.getElementById("start").addEventListener("click",K);document.getElementById("buildGrid").addEventListener("click",S);document.getElementById("visualization_mode").addEventListener("input",
()=>{p=!p});p=document.getElementById("visualization_mode").checked;document.getElementById("mouse_mode").addEventListener("input",()=>{(r=!r)?(document.getElementById("visualization_mode").disabled=!0,p=document.getElementById("visualization_mode").checked=!1):document.getElementById("visualization_mode").disabled=!1});if(r=document.getElementById("mouse_mode").checked)document.getElementById("visualization_mode").disabled=!0,p=document.getElementById("visualization_mode").checked=!1;document.body.onmousedown=
E;document.body.onmousemove=E;document.body.onmouseup=E;B.addEventListener("input",U);C.addEventListener("input",V);C.value="30";B.value="30";document.getElementById("start").disabled=!0;F.draggable=!1;F.j=function(){return!1}})();class u{constructor(){this.j=[]}}u.prototype.u=function(a){this.j.push(a)};u.prototype.B=function(){return this.j.shift()};u.prototype.C=function(){return 0===this.j.length};u.prototype.length=function(){return this.j.length}})();
