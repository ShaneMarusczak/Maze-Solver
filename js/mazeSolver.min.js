(function(){function v(a){return new Promise(d=>setTimeout(d,a))}function P(a){if(H&&!q){let [d,e]=I(a.target),b=h[d][e];b.o||b.s||b.i||(b.i=!0,a.target.classList.add("wall"))}}function n(a,d){return document.getElementById("cell-"+a+"-"+d)}function Q(a){a=a.target;let [d,e]=I(a),b=h[d][e];if(!b.i&&!b.o){for(let c=0;c<l;c++)for(let f=0;f<m;f++){let k=h[c][f],g=n(c,f);k.path=!1;k.i||(k.s=!1,g.classList.remove("end"),g.classList.remove("path"),k.l=!1,k.h=0,g.textContent="")}b.s=!0;a.classList.add("end");
w=b;J(w);D&&t(x)}}function K(){L&&M&&!q&&(document.getElementById("start").removeEventListener("click",K),document.getElementById("start").disabled=!0,document.getElementById("visualization_mode").disabled=!0,document.getElementById("visualization_mode").classList.add("hidden"),document.getElementById("vis_label").classList.add("hidden"),document.getElementById("mouse_mode").disabled=!0,document.getElementById("mouse_mode").classList.add("hidden"),document.getElementById("mouse_label").classList.add("hidden"),
document.getElementById("wallMessage").classList.add("notShown"),r&&Array.from(document.querySelectorAll(".cell")).forEach(a=>{a.addEventListener("mouseover",Q)}),q=!0,J(w),p||r||R(),S(),D&&(p?v(l*m*2.5).then(()=>t(x)):t(x)))}function S(){for(let a=0;a<l;a++)for(let d=0;d<m;d++)n(a,d).classList.remove("cell_hover")}function R(){for(let a=0;a<l;a++)for(let d=0;d<m;d++){let e=h[a][d];e.l||(e.i=!0,n(a,d).classList.add("wall"))}}function t(a){a.path=!0;0!==a.h&&(a.o||(n(a.x,a.y).classList.remove("visited"),
n(a.x,a.y).classList.add("path")),p&&!r?v(200).then(()=>t(a.u())):t(a.u()))}function J(a){let d=1,e=new u;a.l=!0;for(e.v(a);!e.B();){d++;let b=e.A();for(let c of b.g.reverse()){let f=h[c.x][c.y];if("NE"===c.direction&&y("N","E",b,"NE"))b.g.splice(b.g.indexOf(c),1);else if("SE"===c.direction&&y("S","E",b,"SE"))b.g.splice(b.g.indexOf(c),1);else if("SW"===c.direction&&y("S","W",b,"SW"))b.g.splice(b.g.indexOf(c),1);else if("NW"===c.direction&&y("N","W",b,"NW"))b.g.splice(b.g.indexOf(c),1);else if(f.o&&
(D=!0),f.h>b.h+c.m&&f.l&&(f.h=b.h+c.m,p&&v(3*d).then(()=>{n(f.x,f.y).textContent=(b.h+c.m).toString().substring(0,4)})),!f.l&&!f.i){f.l=!0;f.h=b.h+c.m;let k=n(f.x,f.y);p&&!f.o&&v(2*d).then(()=>{k.textContent=(b.h+c.m).toString().substring(0,4);k.classList.add("visited")});f.i||e.v(f)}}}}function y(a,d,e,b){let c=null,f=null,k=null;for(let g of e.g)g.direction===a&&(c=h[g.x][g.y]),g.direction===d&&(f=h[g.x][g.y]),g.direction===b&&(k=h[g.x][g.y]);return null===c||null===f||null===k?!1:c.i&&f.i?!k.i:
!1}function I(a){return[a.id.split("-")[1],a.id.split("-")[2]]}function T(a){!q&&z&&A&&!N&&(l=Number(B.value),m=Number(C.value),B.disabled=!0,C.disabled=!0,a.target.classList.add("hidden"),document.getElementById("start").disabled=!1,document.getElementById("start").classList.remove("hidden"),U(),N=!0,document.getElementById("startMessage").classList.remove("hidden"))}function V(a){/^\d{0,2}$/.test(a.target.value)&&75>=Number(a.target.value)&&0<Number(a.target.value)&&""!==a.target.value?(z=!0,a=
document.getElementById("invalidRows"),"undefined"!=typeof a&&null!=a&&a.remove()):(z&&(a=document.createElement("p"),a.id="invalidRows",a.textContent="Valid range is 1-75 rows",a.classList.add("bad"),document.getElementById("messages").insertBefore(a,document.getElementById("messages").firstChild)),z=!1)}function W(a){/^\d{0,2}$/.test(a.target.value)&&75>=Number(a.target.value)&&0<Number(a.target.value)&&""!==a.target.value?(A=!0,a=document.getElementById("invalidCols"),"undefined"!=typeof a&&null!=
a&&a.remove()):(A&&(a=document.createElement("p"),a.id="invalidCols",a.textContent="Valid range is 1-75 columns",a.classList.add("bad"),document.getElementById("messages").insertBefore(a,document.getElementById("messages").firstChild)),A=!1)}function E(a){H=void 0===a.buttons?1===a.which:1===a.buttons}function U(){for(let a=0;a<m;a++){h.push([]);const d=document.createElement("div");d.id="col-"+a;d.classList.add("col");d.draggable=!1;d.j=function(){return!1};F.appendChild(d);for(let e=0;e<l;e++){const b=
new X(a,e);h[a].push(b);h[a][e].C();const c=document.createElement("div");c.id="cell-"+a+"-"+e;c.classList.add("cell");c.classList.add("cell_hover");625>m*l?c.classList.add("large_cell"):1600>m*l?c.classList.add("medium_cell"):3600>m*l?c.classList.add("small_cell"):c.classList.add("x-small_cell");d.appendChild(c);c.addEventListener("click",()=>b.j());c.draggable=!1;c.j=function(){return!1}}}}let q=!1,N=!1,z=!0,A=!0,l=30,m=30,O=!0,G=!1,L=!1,M=!1,H=!1,p=!1,r=!1,D=!1,x,w;const h=[],F=document.getElementById("gameBoard_UI"),
B=document.getElementById("rowsInput"),C=document.getElementById("colsInput");class X{constructor(a,d){this.x=a;this.y=d;this.g=[];this.s=this.o=this.path=this.i=!1;this.h=0;this.checked=this.l=!1}C(){this.g=[];const a=[-1,0,1];for(let b of a)for(let c of a){var d=this.x+b,e=this.y+c;0<=d&&d<m&&0<=e&&e<l&&(0!==b||0!==c)&&(d=0===b&&-1===c?"N":1===b&&-1===c?"NE":1===b&&0===c?"E":1===b&&1===c?"SE":0===b&&1===c?"S":-1===b&&1===c?"SW":-1===b&&0===c?"W":"NW",0===b||0===c?this.g.push({x:this.x+b,y:this.y+
c,m:1,direction:d}):this.g.push({x:this.x+b,y:this.y+c,m:Math.sqrt(2),direction:d}))}}u(){let a=Infinity,d=null;for(let e of this.g){let b=h[e.x][e.y];b.h<a&&b.l&&!b.i&&(a=b.h,d=b)}return d}j(){if(O&&!q)this.o=!0,n(this.x,this.y).classList.add("start"),x=this,O=!1,L=G=!0,document.getElementById("startMessage").classList.add("hidden"),document.getElementById("endMessage").classList.remove("hidden");else if(G&&!q){w=this;this.s=!0;n(this.x,this.y).classList.add("end");G=!1;M=!0;document.getElementById("endMessage").classList.add("hidden");
document.getElementById("wallMessage").classList.remove("hidden");for(let a=0;a<m;a++)for(let d=0;d<l;d++)n(a,d).addEventListener("mouseover",P)}}}(function(){document.getElementById("start").addEventListener("click",K);document.getElementById("buildGrid").addEventListener("click",T);document.getElementById("visualization_mode").addEventListener("input",()=>{if(p=!p)r=document.getElementById("mouse_mode").checked=!1});document.getElementById("visualization_mode").checked=!1;document.getElementById("mouse_mode").addEventListener("input",
()=>{if(r=!r)p=document.getElementById("visualization_mode").checked=!1});document.getElementById("mouse_mode").checked=!1;document.body.onmousedown=E;document.body.onmousemove=E;document.body.onmouseup=E;B.addEventListener("input",V);C.addEventListener("input",W);C.value="30";B.value="30";document.getElementById("start").disabled=!0;document.oncontextmenu=()=>!1;document.draggable=!1;document.j=function(){return!1};F.draggable=!1;F.j=function(){return!1}})();class u{constructor(){this.j=[]}}u.prototype.v=
function(a){this.j.push(a)};u.prototype.A=function(){return this.j.shift()};u.prototype.B=function(){return 0===this.j.length};u.prototype.length=function(){return this.j.length}})();
