(function(){function x(a){return new Promise(d=>setTimeout(d,a))}function R(a){J();if(K&&!q&&t){let [d,f]=L(a.target),b=h[d][f];b.o||b.s||b.i||(b.i=!0,a.target.classList.add("wall"))}}function l(a,d){return document.getElementById("cell-"+a+"-"+d)}function S(a){a=a.target;let [d,f]=L(a),b=h[d][f];if(!b.i&&!b.o){for(let c=0;c<m;c++)for(let e=0;e<n;e++){let k=h[c][e],g=l(c,e);k.path=!1;k.i||(k.s=!1,g.classList.remove("end"),g.classList.remove("path"),k.j=!1,k.h=0,g.textContent="")}b.s=!0;a.classList.add("end");
y=b;M(y);u&&v(z)}}function J(){window.getSelection?window.getSelection().removeAllRanges():document.selection&&document.selection.empty()}function N(){O&&P&&!q&&(J(),document.getElementById("start").removeEventListener("click",N),document.getElementById("start").disabled=!0,document.getElementById("visualization_mode").disabled=!0,document.getElementById("visualization_mode").classList.add("hidden"),document.getElementById("vis_label").classList.add("hidden"),document.getElementById("mouse_mode").disabled=
!0,document.getElementById("mouse_mode").classList.add("hidden"),document.getElementById("mouse_label").classList.add("hidden"),document.getElementById("wallMessage").classList.add("notShown"),r&&Array.from(document.querySelectorAll(".cell")).forEach(a=>{a.addEventListener("mouseover",S)}),q=!0,t=!1,M(y),p||r||!u||T(),U(),u?p?x(m*n*2.5).then(()=>v(z)):v(z):u||r||(document.getElementById("wallMessage").classList.add("hidden"),document.getElementById("noPathMessage").classList.remove("hidden")))}function U(){for(let a=
0;a<m;a++)for(let d=0;d<n;d++)l(a,d).classList.remove("cell_hover")}function T(){for(let a=0;a<m;a++)for(let d=0;d<n;d++){let f=h[a][d];f.j||(f.i=!0,l(a,d).classList.add("wall"))}}function v(a){a.path=!0;0!==a.h&&(a.o||(l(a.x,a.y).classList.remove("visited"),l(a.x,a.y).classList.add("path")),p&&!r?x(200).then(()=>v(a.u())):v(a.u()))}function M(a){let d=1,f=new w;a.j=!0;for(f.v(a);!f.B();){d++;let b=f.A();for(let c of b.g.reverse()){let e=h[c.x][c.y];if("NE"===c.direction&&A("N","E",b,"NE"))b.g.splice(b.g.indexOf(c),
1);else if("SE"===c.direction&&A("S","E",b,"SE"))b.g.splice(b.g.indexOf(c),1);else if("SW"===c.direction&&A("S","W",b,"SW"))b.g.splice(b.g.indexOf(c),1);else if("NW"===c.direction&&A("N","W",b,"NW"))b.g.splice(b.g.indexOf(c),1);else if(e.o&&(u=!0),e.h>b.h+c.l&&e.j&&(e.h=b.h+c.l,p&&x(3*d).then(()=>{l(e.x,e.y).textContent=(b.h+c.l).toString().substring(0,4)})),!e.j&&!e.i){e.j=!0;e.h=b.h+c.l;let k=l(e.x,e.y);p&&!e.o&&x(2*d).then(()=>{k.textContent=(b.h+c.l).toString().substring(0,4);k.classList.add("visited")});
e.i||f.v(e)}}}}function A(a,d,f,b){let c=null,e=null,k=null;for(let g of f.g)g.direction===a&&(c=h[g.x][g.y]),g.direction===d&&(e=h[g.x][g.y]),g.direction===b&&(k=h[g.x][g.y]);return null===c||null===e||null===k?!1:c.i&&e.i?!k.i:!1}function L(a){return[a.id.split("-")[1],a.id.split("-")[2]]}function V(a){!q&&B&&C&&!Q&&(m=Number(D.value),n=Number(E.value),D.disabled=!0,E.disabled=!0,a.target.classList.add("hidden"),document.getElementById("start").disabled=!1,document.getElementById("start").classList.remove("hidden"),
W(),Q=!0,document.getElementById("startMessage").classList.remove("hidden"))}function X(a){/^\d{0,2}$/.test(a.target.value)&&75>=Number(a.target.value)&&0<Number(a.target.value)&&""!==a.target.value?(B=!0,a=document.getElementById("invalidRows"),"undefined"!=typeof a&&null!=a&&a.remove()):(B&&(a=document.createElement("p"),a.id="invalidRows",a.textContent="Valid range is 1-75 rows",a.classList.add("bad"),document.getElementById("messages").insertBefore(a,document.getElementById("messages").firstChild)),
B=!1)}function Y(a){/^\d{0,2}$/.test(a.target.value)&&75>=Number(a.target.value)&&0<Number(a.target.value)&&""!==a.target.value?(C=!0,a=document.getElementById("invalidCols"),"undefined"!=typeof a&&null!=a&&a.remove()):(C&&(a=document.createElement("p"),a.id="invalidCols",a.textContent="Valid range is 1-75 columns",a.classList.add("bad"),document.getElementById("messages").insertBefore(a,document.getElementById("messages").firstChild)),C=!1)}function G(a){K=void 0===a.buttons?1===a.which:1===a.buttons}
function W(){for(let a=0;a<n;a++){h.push([]);const d=document.createElement("div");d.id="col-"+a;d.classList.add("col");d.draggable=!1;d.ondragstart=function(){return!1};H.appendChild(d);for(let f=0;f<m;f++){const b=new Z(a,f);h[a].push(b);h[a][f].C();const c=document.createElement("div");c.id="cell-"+a+"-"+f;c.classList.add("cell");c.classList.add("cell_hover");625>n*m?c.classList.add("large_cell"):1600>n*m?c.classList.add("medium_cell"):3600>n*m?c.classList.add("small_cell"):c.classList.add("x-small_cell");
d.appendChild(c);c.addEventListener("mouseup",e=>b.m(e));c.draggable=!1;c.ondragstart=function(){return!1}}}}let q=!1,Q=!1,B=!0,C=!0,m=30,n=30,I=!0,F=!1,t=!1,O=!1,P=!1,K=!1,p=!1,r=!1,u=!1,z,y;const h=[],H=document.getElementById("gameBoard_UI"),D=document.getElementById("rowsInput"),E=document.getElementById("colsInput");class Z{constructor(a,d){this.x=a;this.y=d;this.g=[];this.s=this.o=this.path=this.i=!1;this.h=0;this.j=!1}C(){const a=[-1,0,1];for(let b of a)for(let c of a){var d=this.x+b,f=this.y+
c;0<=d&&d<n&&0<=f&&f<m&&(0!==b||0!==c)&&(d=0===b&&-1===c?"N":1===b&&-1===c?"NE":1===b&&0===c?"E":1===b&&1===c?"SE":0===b&&1===c?"S":-1===b&&1===c?"SW":-1===b&&0===c?"W":"NW",0===b||0===c?this.g.push({x:this.x+b,y:this.y+c,l:1,direction:d}):this.g.push({x:this.x+b,y:this.y+c,l:Math.sqrt(2),direction:d}))}}u(){let a=Infinity,d=null;for(let f of this.g){let b=h[f.x][f.y];b.h<a&&b.j&&!b.i&&(a=b.h,d=b)}return d}m(a){if(!I||q||t||0!==a.button)if(!F||q||t||0!==a.button)F||I||!t||q||2!==a.button||(this.i=
!1,l(this.x,this.y).classList.remove("wall"));else for(y=this,this.s=!0,l(this.x,this.y).classList.add("end"),F=!1,P=!0,document.getElementById("endMessage").classList.add("hidden"),document.getElementById("wallMessage").classList.remove("hidden"),t=!0,a=0;a<n;a++)for(let d=0;d<m;d++)l(a,d).addEventListener("mouseover",R);else this.o=!0,l(this.x,this.y).classList.add("start"),z=this,I=!1,O=F=!0,document.getElementById("startMessage").classList.add("hidden"),document.getElementById("endMessage").classList.remove("hidden")}}
(function(){document.getElementById("start").addEventListener("click",N);document.getElementById("buildGrid").addEventListener("click",V);document.getElementById("visualization_mode").addEventListener("input",()=>{if(p=!p)r=document.getElementById("mouse_mode").checked=!1});document.getElementById("visualization_mode").checked=!1;document.getElementById("mouse_mode").addEventListener("input",()=>{if(r=!r)p=document.getElementById("visualization_mode").checked=!1});document.getElementById("mouse_mode").checked=
!1;document.body.onmousedown=G;document.body.onmousemove=G;document.body.onmouseup=G;D.addEventListener("input",X);E.addEventListener("input",Y);E.value="30";D.value="30";document.getElementById("start").disabled=!0;document.oncontextmenu=()=>!1;document.draggable=!1;document.ondragstart=function(){return!1};H.draggable=!1;H.ondragstart=function(){return!1}})();class w{constructor(){this.m=[]}}w.prototype.v=function(a){this.m.push(a)};w.prototype.A=function(){return this.m.shift()};w.prototype.B=
function(){return 0===this.m.length};w.prototype.length=function(){return this.m.length}})();
